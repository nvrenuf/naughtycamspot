---
import { bannerSlots, getBannerSlot, type BannerSlotId } from '../data/banners';
import { buildTrackedLink } from '../utils/links';

interface Props {
  id: BannerSlotId;
  class?: string;
}

const { id, class: className = '' } = Astro.props as Props;
const slot = getBannerSlot(id);

if (!slot) {
  const available = Object.keys(bannerSlots).join(', ');
  throw new Error(`Banner slot "${id}" is not defined. Available slots: ${available}`);
}

const href = buildTrackedLink({
  path: slot.path,
  slot: slot.id,
  camp: slot.camp,
  placeholder: slot.placeholder
});

const anchorClass = [
  'banner-slot block overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-3 text-center shadow-glow',
  className
]
  .filter(Boolean)
  .join(' ');
---
<a class={anchorClass} href={href} target="_blank" rel="nofollow sponsored">
  <img
    src={slot.image}
    alt={slot.alt}
    width={slot.width}
    height={slot.height}
    loading="lazy"
    decoding="async"
    class="h-auto w-full object-cover"
  />
</a>
